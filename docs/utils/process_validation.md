# Documentation on process validation module
This document is a code walk-through on process_validation.py module

## Overview
- The [process_validation](https://github.com/ncsa/ameriflux-pipeline/blob/develop/ameriflux_pipeline/utils/process_validation.py) module is a utility function that supports various process validations.
- This module is used throughout the pipeline at various stages.
- This is not a standalone module and does not produce any output files.

## Process
- The [process_validation](https://github.com/ncsa/ameriflux-pipeline/blob/develop/ameriflux_pipeline/utils/process_validation.py) module ensures that each process in the pipeline works as expected.
- The module contains multiple methods for data validation and validations for L1 and L2 file formats.
- The functionalities of this module is explained below.

### 1
- Datatype validation 
  - Integer validation checks if the input is a valid integer.
  - Float validation checks if the input is a valid floating point number
  - String validation checks if the input is a valid string type
  - URL validation checks if the input has a valid url format
  - Domain validation checks if the input has a valid domain
  - IP validation checks if the input is has a valid IP format
  - Datetime validation checks if the input has a valid datetime format
  - Is_empty validation checks if the input directory is empty

### 2
- Data comparison
  - Equality validation checks if the two inputs are equal in value and datatype
  - Path validation checks if the input is a file or a directory 
  - Filetype validation checks if the input file meets the expected filetype (csv/txt/excel)
  - Is_file_in_directory checks if the input file exists in the given directory

### 3
- Data and file format validation
  - Is_meta_data method checks if the metadata extracted from the meteorological data file is in the expected format. See [NOTES#1](https://github.com/ncsa/ameriflux-pipeline/blob/develop/NOTES.md#1) and [metprocessor step#3](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/metprocessor.md#3)
  - Is_valid_soils_key method checks if the user input soils_key file is as expected. See [eddyproformat](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/eddypro/eddyproformat.md#2)
  - Is_valida_full_output method checks if the full output generated by EddyPro software meets expected format. See [pyfluxproformat](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/pyfluxpro/pyfluxproformat.md#2) module.
  - Is_valid_met_key method checks if the metmerger-key file meets expected format. See [metprocessor](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/metprocessor.md#1) module.
  - Is_valid_ameriflux_mainstem_key method checks if the input Ameriflux-Mainstem-Key file meets expected format.
  - Is_valid_erroring_variables_key method checks if the user input Erroring-Variables-Key file meets expected format. See [pre_pyfluxpro](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/prepyfluxpro.md#3) documentation for details.

### 4
- L1 validation checks are done for the user input L1 template files. The validations done are below:
  - Checks if the level is L1
  - The L1 files are checked if the "[Files]", "[Global]" and "[Variables]" section exists.
  - Checks if the number of spaces for each line adheres to the PyFluxPro software standards.
  - Checks if the required lines are there for the "[Files]" section. For example, "file_path" and "out_filename".
  - Checks if an "Acknowledgement" line and "site_name" is there in the "[Global]" section.
  - Checks if "xl" and "attr" attributes are there for "[Variables]" section.
  - Checks if "units" and "long name" lines are there in "attr" attribute.
  - Checks if "sheet name" and "name" lines are there in "xl" attribute.
- See [l1format](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/pyfluxpro/l1format.md#2) module for details.

### 5
- L2 validation checks are done for the user input L2 template files. The validations done are below:
  - Checks if the level is L2
  - The L1 files are checked if the "[Variables]" and "[Plots]" section exists.
  - Checks if the number of spaces for each line adheres to the PyFluxPro software standards.
  - Checks for correct formats for PyFluxPro checks.
- See [l2format](https://github.com/ncsa/ameriflux-pipeline/blob/develop/docs/pyfluxpro/l2format.md#2) module for details.